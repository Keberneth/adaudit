<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AD Audit - Management Summary</title>
<style>
:root{
  --bg:#0b1220; --text:#e8edf6; --muted:#b7c0d6; --line:rgba(255,255,255,.10);
  --shadow:0 10px 30px rgba(0,0,0,.35); --radius:14px;
  --critical-bg:rgba(255,77,79,.18); --high-bg:rgba(255,169,64,.18);
  --medium-bg:rgba(105,177,255,.18); --low-bg:rgba(149,222,100,.18);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1200px 700px at 20% 10%, rgba(105,177,255,.18), transparent 60%),
              radial-gradient(1200px 700px at 80% 0%, rgba(255,169,64,.16), transparent 55%),
              var(--bg);
  color:var(--text);
}
a{color:#cfe1ff;text-decoration:none} a:hover{text-decoration:underline}
.container{max-width:1200px;margin:0 auto;padding:28px 20px 60px}
.header{
  background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  border:1px solid var(--line); border-radius: var(--radius); box-shadow: var(--shadow);
  padding:22px 22px 18px;
}
.h-title{display:flex;align-items:flex-start;justify-content:space-between;gap:18px;flex-wrap:wrap}
h1{font-size:22px;margin:0 0 6px;letter-spacing:.2px}
.meta{color:var(--muted);font-size:13px}
.badge{
  display:inline-flex;align-items:center;gap:10px;
  padding:10px 12px;border-radius:999px;border:1px solid var(--line);
  background: rgba(255,255,255,.06); font-weight:700;
}
.badge .grade{font-size:13px;color:var(--muted);font-weight:600}
.badge .value{font-size:15px}
.badge.Critical{background:var(--critical-bg)} .badge.High{background:var(--high-bg)}
.badge.Medium{background:var(--medium-bg)} .badge.Low{background:var(--low-bg)}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:14px}
.card{
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid var(--line); border-radius: var(--radius); box-shadow: var(--shadow);
  padding:14px 14px 12px; min-height:88px;
}
.card .k{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.12em}
.card .v{font-size:22px;font-weight:800;margin-top:6px}
.card .s{margin-top:4px;color:var(--muted);font-size:12px}
.span-3{grid-column:span 3} .span-4{grid-column:span 4}
.pill{
  display:inline-flex;align-items:center;justify-content:center;
  padding:4px 10px;border-radius:999px;font-weight:800;font-size:12px;
  border:1px solid var(--line);
  min-width:86px;
}
.sev-Critical{background:var(--critical-bg)} .sev-High{background:var(--high-bg)}
.sev-Medium{background:var(--medium-bg)} .sev-Low{background:var(--low-bg)}
.section{margin-top:18px} .section h2{margin:0 0 10px;font-size:16px}
.callout{border:1px solid var(--line);border-radius: var(--radius);padding:14px;background: rgba(255,255,255,.05)}
.callout p{margin:0;line-height:1.4} .callout ul{margin:10px 0 0 18px} .callout li{margin:6px 0}
.toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin:10px 0}
.filters{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

/* INPUTS (dropdown options readable) */
select,input{
  background:rgba(255,255,255,.06);
  color:var(--text);
  border:1px solid var(--line);
  border-radius:10px;
  padding:8px 10px;
  outline:none;
}
input{min-width:240px}
small{color:var(--muted)}
select option{ background:#0b1220; color:#ffffff; }

table{width:100%;border-collapse:collapse;border:1px solid var(--line);border-radius:var(--radius);overflow:hidden;background:rgba(255,255,255,.03)}
th,td{padding:10px;border-bottom:1px solid var(--line);vertical-align:top}
th{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.12em;background: rgba(255,255,255,.05);cursor:pointer;user-select:none}
tr:hover td{background:rgba(255,255,255,.04)}
td.score{font-weight:800} td.title{font-weight:700}
.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
td.source .mono{font-size:12px;color:#d7e6ff}
pre{white-space:pre-wrap;background:rgba(0,0,0,.25);border:1px solid var(--line);border-radius: var(--radius);padding:12px;color:#dbe6ff;overflow:auto}
.footer{margin-top:16px;color:var(--muted);font-size:12px}

/* SCORE MATRIX ALIGNMENT */
.matrix-wrap{margin-top:10px}
table.matrix{
  table-layout:fixed;
}
table.matrix th, table.matrix td{
  padding:14px 18px;
}
table.matrix th{ cursor:default; }
table.matrix th:nth-child(1), table.matrix td:nth-child(1){
  width:18%;
  padding-left:22px;
}
table.matrix th:nth-child(2), table.matrix td:nth-child(2){
  width:18%;
  text-align:center;
}
table.matrix th:nth-child(3), table.matrix td:nth-child(3){
  width:64%;
  padding-left:22px;
}
.matrix-row.active td{background:rgba(255,255,255,.06)}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="h-title">
      <div>
        <h1>Active Directory Audit - Management Summary</h1>
        <div class="meta">Target: <span class="mono">contoso-ad-server1</span> | Generated: 2025-12-26 18:19:15 UTC</div>
      </div>
      <div class="badge Critical">
        <div>
          <div class="grade">Overall Risk</div>
          <div class="value">Critical</div>
        </div>
        <div style="width:1px;height:28px;background:var(--line)"></div>
        <div>
          <div class="grade">Score</div>
          <div class="value">187</div>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="card span-3"><div class="k">Critical findings</div><div class="v">5</div><div class="s">Immediate remediation</div></div>
      <div class="card span-3"><div class="k">High findings</div><div class="v">13</div><div class="s">Prioritize</div></div>
      <div class="card span-3"><div class="k">Medium findings</div><div class="v">4</div><div class="s">Plan hardening</div></div>
      <div class="card span-3"><div class="k">Low findings</div><div class="v">3</div><div class="s">Maintain baseline</div></div>

      <div class="card span-4"><div class="k">Users</div><div class="v">480</div><div class="s">From ADExtract (if present)</div></div>
      <div class="card span-4"><div class="k">Groups</div><div class="v">372</div><div class="s">From ADExtract (if present)</div></div>
      <div class="card span-4"><div class="k">OUs</div><div class="v">39</div><div class="s">From ADExtract (if present)</div></div>
    </div>
  </div>

  <div class="section">
    <h2>Interpretation</h2>
    <div class="callout">
      <p><b>What this means:</b> The overall score indicates significant gaps relative to the defined baselines. Prioritize remediation for the highest-severity items and confirm governance for privileged access and password controls.</p>

      <div class="matrix-wrap">
        <p style="margin-top:12px"><b>Score matrix:</b> The total score is mapped to a risk level as follows (current score highlighted).</p><br>
        <table class="matrix">
          <thead>
            <tr>
              <th>Level</th>
              <th>Score range</th>
              <th>Interpretation</th>
            </tr>
          </thead>
          <tbody>
            <tr class="matrix-row sev-Low">
  <td><span class="pill sev-Low">Low</span></td>
  <td class="mono">0 - 49</td>
  <td class="matrix-meaning">Minor control gaps or baseline drift. Address during routine maintenance and continue monitoring.</td>
</tr>
<tr class="matrix-row sev-Medium">
  <td><span class="pill sev-Medium">Medium</span></td>
  <td class="mono">50 - 99</td>
  <td class="matrix-meaning">Noticeable control gaps. Plan remediation in the next hardening cycle and track to closure.</td>
</tr>
<tr class="matrix-row sev-High">
  <td><span class="pill sev-High">High</span></td>
  <td class="mono">100 - 149</td>
  <td class="matrix-meaning">Major control gaps. Prioritize remediation and validate that administrative controls are applied consistently.</td>
</tr>
<tr class="matrix-row active sev-Critical">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="mono">150+</td>
  <td class="matrix-meaning">Significant control gaps or privileged configuration drift. Treat as a priority workstream with defined owners and timelines.</td>
</tr>
          </tbody>
        </table>
      </div>

      <p style="margin-top:12px"><b>Recommended next steps:</b></p>
      <ul>
        <li>Assign owners for Critical findings and define target dates for remediation.</li>
<li>Review privileged group membership (Domain Admins / Schema Admins / built-in administrators) and ensure membership is justified, documented, and reviewed regularly.</li>
<li>Address password control items (duplicate passwords, PasswordNeverExpires usage, KRBTGT rotation policy) and confirm they align with operational requirements.</li>
<li>Re-run the assessment after remediation to confirm closure and reduce configuration drift.</li>
      </ul>

      <div class="footer">Note: This score is an index based on the findings included in this report and the evidence files available under the input folder. Validate scope and collection completeness.</div>
    </div>
  </div>

  <div class="section">
    <h2>Findings</h2>
    <div class="toolbar">
      <div class="filters">
        <label>
          <small>Severity</small><br>
          <select id="sevFilter">
            <option>All</option>
            <option>Critical</option>
            <option>High</option>
            <option>Medium</option>
            <option>Low</option>
          </select>
        </label>
        <label>
          <small>Search</small><br>
          <input id="search" type="text" placeholder="Search title/evidence/source...">
        </label>
      </div>
      <div>
        <small>Visible: <span id="visibleCount">0</span> / 25</small>
      </div>
    </div>

    <table id="findings">
      <thead>
        <tr>
          <th data-sort="severity">Severity</th>
          <th data-sort="title">Finding</th>
          <th>Evidence</th>
          <th data-sort="score">Score</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody id="findings-body">
        <tr data-sev="Critical" data-score="12">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="title">Duplicate passwords (duplicate NT hashes)</td>
  <td class="evidence">Observed: 11 duplicate-hash groups; 26 affected accounts | Baseline: 0</td>
  <td class="score">12</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="Critical" data-score="12">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="title">Domain Admins</td>
  <td class="evidence">Observed: 27 | Baseline: &lt;= 5</td>
  <td class="score">12</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="Critical" data-score="12">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="title">Schema Admins</td>
  <td class="evidence">Observed: 19 | Baseline: 0 (except during schema change)</td>
  <td class="score">12</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="Critical" data-score="12">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="title">krbtgt password age</td>
  <td class="evidence">Observed: 11/01/2019 12:09:57 (2247 days) | Baseline: &lt;= 180 days</td>
  <td class="score">12</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="Critical" data-score="10">
  <td><span class="pill sev-Critical">Critical</span></td>
  <td class="title">Duplicate passwords detected</td>
  <td class="evidence">Accounts with identical password hashes: 26</td>
  <td class="score">10</td>
  <td class="source"><a href="HighRisk\DUPLICATE_PASSWORDS.csv"><span class="mono">HighRisk\DUPLICATE_PASSWORDS.csv</span></a></td>
</tr>
<tr data-sev="High" data-score="10">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Accounts with password set to not expire</td>
  <td class="evidence">Accounts: 111</td>
  <td class="score">10</td>
  <td class="source"><a href="accounts_passdontexpire.txt"><span class="mono">accounts_passdontexpire.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="10">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Large privileged group membership</td>
  <td class="evidence">Rows: 84</td>
  <td class="score">10</td>
  <td class="source"><a href="HighRisk\PRIVILEGED_GROUPS.csv"><span class="mono">HighRisk\PRIVILEGED_GROUPS.csv</span></a></td>
</tr>
<tr data-sev="High" data-score="10">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Passwords set to never expire</td>
  <td class="evidence">Accounts: 111</td>
  <td class="score">10</td>
  <td class="source"><a href="HighRisk\PASSWORD_NEVER_EXPIRES.csv"><span class="mono">HighRisk\PASSWORD_NEVER_EXPIRES.csv</span></a></td>
</tr>
<tr data-sev="High" data-score="9">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">BUILTIN\Administrators</td>
  <td class="evidence">Observed: 32 | Baseline: Minimal</td>
  <td class="score">9</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="9">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Enabled user accounts with PasswordNeverExpires</td>
  <td class="evidence">Observed: 111 | Baseline: 0 (humans); services should use gMSA/MSA</td>
  <td class="score">9</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="9">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Enabled accounts inactive &gt; 180 days</td>
  <td class="evidence">Observed: 129 | Baseline: 0 (disable if inactive &gt; 180 days)</td>
  <td class="score">9</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="9">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">ms-DS-MachineAccountQuota</td>
  <td class="evidence">Observed: 10 | Baseline: 0</td>
  <td class="score">9</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="8">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Domain Admins membership size</td>
  <td class="evidence">Members: 32</td>
  <td class="score">8</td>
  <td class="source"><a href="domain_admins.txt"><span class="mono">domain_admins.txt</span></a></td>
</tr>
<tr data-sev="Medium" data-score="8">
  <td><span class="pill sev-Medium">Medium</span></td>
  <td class="title">Inactive enabled accounts</td>
  <td class="evidence">Accounts inactive: 183</td>
  <td class="score">8</td>
  <td class="source"><a href="HighRisk\INACTIVE_ACCOUNTS.csv"><span class="mono">HighRisk\INACTIVE_ACCOUNTS.csv</span></a></td>
</tr>
<tr data-sev="Medium" data-score="7">
  <td><span class="pill sev-Medium">Medium</span></td>
  <td class="title">Disabled accounts not reviewed &gt; 180 days</td>
  <td class="evidence">Observed: 133 | Baseline: 0 (review/remove if disabled &gt; 180 days)</td>
  <td class="score">7</td>
  <td class="source"><a href="ad_high_risk_baseline.txt"><span class="mono">ad_high_risk_baseline.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="6">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Schema Admins membership size</td>
  <td class="evidence">Members: 19</td>
  <td class="score">6</td>
  <td class="source"><a href="schema_admins.txt"><span class="mono">schema_admins.txt</span></a></td>
</tr>
<tr data-sev="Low" data-score="6">
  <td><span class="pill sev-Low">Low</span></td>
  <td class="title">Disabled stale accounts</td>
  <td class="evidence">Accounts: 133</td>
  <td class="score">6</td>
  <td class="source"><a href="HighRisk\DISABLED_STALE.csv"><span class="mono">HighRisk\DISABLED_STALE.csv</span></a></td>
</tr>
<tr data-sev="High" data-score="5">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Accounts without Kerberos pre-auth (AS-REP roastable)</td>
  <td class="evidence">Accounts: 1</td>
  <td class="score">5</td>
  <td class="source"><a href="ASREP.txt"><span class="mono">ASREP.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="5">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Domain controllers allow weak Kerberos ciphers</td>
  <td class="evidence">DCs flagged: 9</td>
  <td class="score">5</td>
  <td class="source"><a href="dcs_weak_kerberos_ciphersuite.txt"><span class="mono">dcs_weak_kerberos_ciphersuite.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="5">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">Delegated permissions risks detected</td>
  <td class="evidence">High/Critical items: 1</td>
  <td class="score">5</td>
  <td class="source"><a href="DelegatedPermissions\ADAudit_Reports_20251226_013747\ADAudit_RiskAssessment.txt"><span class="mono">DelegatedPermissions\ADAudit_Reports_20251226_013747\ADAudit_RiskAssessment.txt</span></a></td>
</tr>
<tr data-sev="High" data-score="5">
  <td><span class="pill sev-High">High</span></td>
  <td class="title">LDAP security misconfiguration detected</td>
  <td class="evidence">See LDAPSecurity.txt for details</td>
  <td class="score">5</td>
  <td class="source"><a href="LDAPSecurity.txt"><span class="mono">LDAPSecurity.txt</span></a></td>
</tr>
<tr data-sev="Medium" data-score="3">
  <td><span class="pill sev-Medium">Medium</span></td>
  <td class="title">NTLM restrictions require hardening</td>
  <td class="evidence">Review NTLM configuration and restrictions</td>
  <td class="score">3</td>
  <td class="source"><a href="ntlm_restrictions.txt"><span class="mono">ntlm_restrictions.txt</span></a></td>
</tr>
<tr data-sev="Medium" data-score="3">
  <td><span class="pill sev-Medium">Medium</span></td>
  <td class="title">Kerberoastable SPNs present (review high-value service accounts)</td>
  <td class="evidence">Lines: 1</td>
  <td class="score">3</td>
  <td class="source"><a href="SPNs.txt"><span class="mono">SPNs.txt</span></a></td>
</tr>
<tr data-sev="Low" data-score="1">
  <td><span class="pill sev-Low">Low</span></td>
  <td class="title">Delegated permissions recommendations available</td>
  <td class="evidence">See recommendations file</td>
  <td class="score">1</td>
  <td class="source"><a href="DelegatedPermissions\ADAudit_Reports_20251226_013747\ADAudit_Recommendations.txt"><span class="mono">DelegatedPermissions\ADAudit_Reports_20251226_013747\ADAudit_Recommendations.txt</span></a></td>
</tr>
<tr data-sev="Low" data-score="1">
  <td><span class="pill sev-Low">Low</span></td>
  <td class="title">Enterprise Admins membership size</td>
  <td class="evidence">Members: 1</td>
  <td class="score">1</td>
  <td class="source"><a href="enterprise_admins.txt"><span class="mono">enterprise_admins.txt</span></a></td>
</tr>
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>Baseline and Notes</h2>
    <pre>=== Active Directory High Risk Baseline Report ===
Generated: 2025-12-26T01:12:29.5128040+01:00
Domain:   contoso.onmicrosoft.com
Forest:   contoso.onmicrosoft.com

Baseline (target values)
--------------------------------------------------------------------------------
Domain Admins (permanent members): &lt;= 5
Enterprise Admins (permanent members): 0-2 (temporary only)
Schema Admins (permanent members): 0 (except during schema change)
BUILTIN\Administrators (permanent members): Minimal (avoid non-DA users)
Account Operators / Server Operators / Backup Operators / Print Operators: Empty
krbtgt password age: &lt;= 180 days (rotate; 2x after incident)
Enabled user inactivity: Disable if inactive &gt; 180 days (adjust to org policy)
Disabled user retention: Review/remove if disabled &gt; 180 days
Password never expires (humans): 0 (use gMSA/MSA for services)
MachineAccountQuota: 0
Duplicate passwords: 0 shared passwords (no duplicate NT hashes)
Windows cumulative update (Patch Tuesday): Latest monthly cumulative update installed (current Patch Tuesday cycle)

Findings
--------------------------------------------------------------------------------
[CRITICAL] krbtgt password age | Observed: 11/01/2019 12:09:57 (2247 days) | Baseline: &lt;= 180 days
[CRITICAL] Domain Admins | Observed: 27 | Baseline: &lt;= 5
[CRITICAL] Schema Admins | Observed: 12 | Baseline: 0 (except during schema change)
[CRITICAL] Duplicate passwords (duplicate NT hashes) | Observed: 11 duplicate-hash groups; 26 affected accounts | Baseline: 0
[HIGH]     Enabled accounts inactive &gt; 180 days | Observed: 183 | Baseline: 0 (disable if inactive &gt; 180 days)
[HIGH]     ms-DS-MachineAccountQuota | Observed: 10 | Baseline: 0
[HIGH]     BUILTIN\Administrators | Observed: 27 | Baseline: Minimal
[HIGH]     Enabled user accounts with PasswordNeverExpires | Observed: 111 | Baseline: 0 (humans); services should use gMSA/MSA
[MEDIUM]   Disabled accounts not reviewed &gt; 180 days | Observed: 133 | Baseline: 0 (review/remove if disabled &gt; 180 days)

Recommendations (per finding)
--------------------------------------------------------------------------------
KRB_KRBTGT [CRITICAL] krbtgt password age
  Baseline: &lt;= 180 days
  Observed: 11/01/2019 12:09:57 (2247 days)
  Action:   Rotate krbtgt regularly; after incident perform two resets per Microsoft guidance (allow ticket lifetime between resets).

PRIV_DA [CRITICAL] Domain Admins
  Baseline: &lt;= 5
  Observed: 27
  Action:   Minimize permanent membership; use JIT/PIM where possible; keep Tier0 separate; monitor changes.

PRIV_SA [CRITICAL] Schema Admins
  Baseline: 0 (except during schema change)
  Observed: 19
  Action:   Minimize permanent membership; use JIT/PIM where possible; keep Tier0 separate; monitor changes.

PWD_DUPLICATE [CRITICAL] Duplicate passwords (duplicate NT hashes)
  Baseline: 0
  Observed: 11 duplicate-hash groups; 26 affected accounts
  Action:   Eliminate password reuse; prioritize privileged accounts; enforce unique passwords; rotate; consider banned password lists.

ACCT_INACTIVE [HIGH] Enabled accounts inactive &gt; 180 days
  Baseline: 0 (disable if inactive &gt; 180 days)
  Observed: 183
  Action:   Disable or remove accounts that are no longer used; verify HR/offboarding; prioritize privileged and service accounts.

DOMAIN_MAQ [HIGH] ms-DS-MachineAccountQuota
  Baseline: 0
  Observed: 10
  Action:   Set ms-DS-MachineAccountQuota to 0; delegate domain join to a controlled group/process; monitor computer object creation.

PRIV_ADM [HIGH] BUILTIN\Administrators
  Baseline: Minimal
  Observed: 27
  Action:   Minimize permanent membership; use JIT/PIM where possible; keep Tier0 separate; monitor changes.

PWD_NEVER_EXPIRES [HIGH] Enabled user accounts with PasswordNeverExpires
  Baseline: 0 (humans); services should use gMSA/MSA
  Observed: 111
  Action:   Eliminate non-expiring human passwords; migrate service accounts to gMSA; rotate credentials; enforce MFA for admins.

ACCT_DISABLED_STALE [MEDIUM] Disabled accounts not reviewed &gt; 180 days
  Baseline: 0 (review/remove if disabled &gt; 180 days)
  Observed: 133
  Action:   Remove or archive long-disabled accounts; verify business/legal retention; reduce directory clutter and attack surface.
</pre>
  </div>

  <div class="footer">
    Generated by the Management Report script. Review detailed findings and evidence files for remediation actions.<br>
    This report summarizes configuration and baseline observations. It should be reviewed alongside operational context and existing compensating controls.
  </div>
</div>

<script>
(function(){
  function q(sel){return document.querySelector(sel);}
  function qa(sel){return Array.prototype.slice.call(document.querySelectorAll(sel));}
  function rows(){return qa('#findings-body tr');}

  function applyFilters(){
    var sev = q('#sevFilter').value;
    var s = (q('#search').value || '').toLowerCase().trim();
    var visible = 0;

    rows().forEach(function(r){
      var rsev = r.getAttribute('data-sev');
      var text = (r.innerText || '').toLowerCase();
      var okSev = (sev === 'All') || (rsev === sev);
      var okSearch = (!s) || (text.indexOf(s) >= 0);
      var show = okSev && okSearch;
      r.style.display = show ? '' : 'none';
      if (show) visible++;
    });
    q('#visibleCount').innerText = visible;
  }

  var sortCol = null;
  var sortAsc = false;
  var order = ['Critical','High','Medium','Low'];

  function sortBy(col){
    sortAsc = (sortCol === col) ? !sortAsc : true;
    sortCol = col;

    var arr = rows().slice().sort(function(a,b){
      var ka, kb;
      if(col === 'severity'){
        ka = order.indexOf(a.getAttribute('data-sev'));
        kb = order.indexOf(b.getAttribute('data-sev'));
      } else if(col === 'score'){
        ka = parseInt(a.getAttribute('data-score') || '0',10);
        kb = parseInt(b.getAttribute('data-score') || '0',10);
      } else if(col === 'title'){
        ka = (a.querySelector('.title') || {}).innerText || '';
        kb = (b.querySelector('.title') || {}).innerText || '';
      } else {
        ka = a.innerText; kb = b.innerText;
      }
      if(ka < kb) return sortAsc ? -1 : 1;
      if(ka > kb) return sortAsc ? 1 : -1;
      return 0;
    });

    var tbody = q('#findings-body');
    arr.forEach(function(r){tbody.appendChild(r);});
    applyFilters();
  }

  q('#sevFilter').addEventListener('change', applyFilters);
  q('#search').addEventListener('input', applyFilters);
  qa('th[data-sort]').forEach(function(th){
    th.addEventListener('click', function(){ sortBy(th.getAttribute('data-sort')); });
  });

  applyFilters();
  sortBy('score'); sortBy('score'); // start desc
})();
</script>
</body>
</html>
